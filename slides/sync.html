<section>
    <h1>Riddle</h1>
    <include src="examples/riddle.js.html"></include>
    <h2>What is the order of messages logged?</h2>
    <ol>
        <li><code>start, timeout, end</code></li>
        <li><code>start, end, timeout</code></li>
    </ol>
</section>

<section>
    <h1>Answer</h1>
    <include src="examples/riddle.js.html"></include>
    <include src="examples/riddle.txt.html"></include>
</section>

<section>
    <h1>The real riddle</h1>
    <include src="examples/riddle2.js.html"></include>
    <h2>What is the order of messages logged?</h2>
</section>

<section>
    <h1>The real answer</h1>
    <include src="examples/riddle2.js.html"></include>
    <include src="examples/riddle2.txt.html"></include>
</section>

<section>
    <h1>Why?</h1>
    <img src="img/wtf.jpg">
</section>

<section>
    <h1>Microtasks</h1>
    <img src="img/magnets.jpg">
</section>

<section>
    <h2>What are microtasks?</h2>
    <h1 class="fragment">What are tasks?</h1>
</section>

<section>
    <h1>Tasks</h1>
    <ul>
        <li>mouse click callback firing</li>
        <li>parsing HTML</li>
        <li><code>setTimeout</code></li>
    </ul>
</section>

<section>
    <h1>Microtasks</h1>
    <ul>
        <li>mutation observer callbacks (<code>MutationObserver</code>)</li>
        <li>promise callbacks</li>
    </ul>
</section>

<section>
    <h1>How are those handled?</h1>
</section>

<section>
    <h1>Did you know?</h1>
    <h2 class="fragment">The event loop has more task queues.</h2>
</section>

<section>
    <h2>Event loop processing</h2>
    <ol>
        <li>pick up a <strong>task</strong> from the <em>task queue</em></li>
        <li>run the <strong>task</strong></li>
        <li>
            handle <strong>microtasks</strong>
            <ol>
                <li>pick up oldest <strong>microtask</strong> from <em>microtask queue</em></li>
                <li>run the <strong>microtask</strong></li>
                <li><span style="text-decoration: underline">repeat</span> until there are no more <strong>microtasks</strong></li>
            </ol>
        </li>
        <li>render</li>
        <li>go to 1</li>
    </ol>
</section>

<section>
    <h2>Are Promises asynchronous?</h2>
    <h1 class="fragment">Yes</h1>
    <h2 class="fragment">but &hellip;</h2>
</section>

<section>
    <h2>Is <code>Promise.then</code> the new <code>setTimeout</code>?</h2>
    <include src="examples/timeout.js.html"></include>
</section>

<section>
    <h2>Experiment</h2>
    <include src="examples/halt2.js.html"></include>
</section>

<section>
    <h2>Experiment</h1>
    <div class="spinner" data-func="timeout">☯</div>
    <div class="spinner" data-func="promise">☯</div>
</section>

<section>
    <h1>Experiment</h1>
    <div>
        <img src="img/science.jpg" style="height: 400px">
    </div>
</section>
